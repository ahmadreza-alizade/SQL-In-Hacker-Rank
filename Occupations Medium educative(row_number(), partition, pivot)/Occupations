SELECT 
--cause the selection is only one item we can use both min() and max() in this query.
    MAX(CASE WHEN Occupation = 'Doctor' THEN Name ELSE NULL END) AS Doctor, 
    MAX(CASE WHEN Occupation = 'Professor' THEN Name ELSE NULL END) AS Professor, 
    MAX(CASE WHEN Occupation = 'Singer' THEN Name ELSE NULL END) AS Singer, 
    MAX(CASE WHEN Occupation = 'Actor' THEN Name ELSE NULL END) AS Actor 
FROM ( 
    SELECT Name, Occupation, ROW_NUMBER() OVER (partition by occupation order by name) as RowNum   
    FROM OCCUPATIONS 
    ) AS Temp 
GROUP BY RowNum ORDER BY RowNum;
